### Websocket
  * 概念  
    + WebSocket是基于TCP的应用层协议，用于在C/S架构的应用中实现双向通信；它基于TCP传输协议，并复用HTTP的握手通道，客户端通过HTTP请求与WebSocket服务端协商升级协议，协议升级完成后，后续的数据交换则遵照WebSocket的协议。  
  * 与Http比较  
    + Websocket 支持双向通信，实时性更强；  
    + 更好的二进制支持；   
    + 较小的控制开销；    
    + 支持扩展，
    
  * 鉴权 
   + 建立连接时需要，将token放在header中    
    + 可以在websocket的 `url?token={token}`    
  * 心跳检测  
    + 思路： 每隔一段固定的时间，向服务器端发送一个ping数据，如果在正常的情况下，服务器会返回一个pong给客户端，如果客户端通过onmessage事件能监听到的话，说明请求正常
  
  * 断线重连
    + 首先通过定时发送心跳包的方式检测当前连接是否可用，同时监测网络恢复事件，在恢复后立即发送一次心跳，快速感知当前状态，判断是否需要重连；
    + 其次正常情况下由服务器断开旧连接，与服务器失去联系时直接弃用旧连接，上层模拟断开，来实现快速断开；
    + 最后发起新连接时使用退避算法延迟一段时间再发起连接，同时考虑到资源浪费和重连速度，可以在网络离线时调大重连间隔，在网络正常或网络由offline变为online时缩小重连间隔，使之尽可能快地重连上。
  
  
### JWT( JSON WEB TOKEN )
   * 概念   
     为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准。该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。  
   
   * 对比session和token
     + 传统的session和cookie   
       - http面向无状态、无状态的，所以产生了session和cookie，用来记录身份
       - 缺点：
         1. 每个用户认证之后，都会在后端记录一个，session会存在内存中，随着用户规模增大，服务端开销会很大  
         2. 用户认证之后，session保存在内存中，下次用户必须访问这台服务器，这样就限制了负载均衡，也就限制了应用的扩展能力 
         3. 因为是基于cookie来认证客户端，当cookie被截获，用户就会很容易受到跨站请求伪造的攻击   
         
     + token    
       - 客户端的token中自己保留有大量信息，服务器没有存储这些信息   
       - 缺点：
         1. 服务端验证客户发送的token时，需要查询数据库获取用户信息，然后验证token是否有效   
         
     + JWT   
       - 包含Header( {alg: 'H256', typ: 'JWT'} )、Playload和Signature签名  
       - 加密算法：HMACSHA256( base64UrlEncode(header) + “.” + base64UrlEncode(payload), secret)；secret只有服务器知道   
       - 使用方式：   
         1. 放在 HTTP 请求的头信息Authorization字段里面 Authorization: Bearer <token>   
         2. 跨域的时候，JWT 就放在 POST 请求的数据体里面   
         
       - 优点  
         1. 因为json的通用性，所以JWT是可以进行跨语言支持的   
         2. 因为有了payload部分，所以JWT可以在自身存储一些其他业务逻辑所必要的非敏感信息   
         3. 便于传输，jwt的构成非常简单，字节占用很小，所以它是非常便于传输的  
         4. 它不需要在服务端保存会话信息，所以它易于应用的扩展
       
